<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shortage Index</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Shortage Index</h1>
    <p>Welcome to the shortage index webpage!</p>
    <div>
        <canvas id="shortageChart"></canvas>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        fetch('shortage_index.xlsx')
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[sheetName];
                const shortageData = XLSX.utils.sheet_to_json(worksheet, { header: 1, raw: false, dateNF: 'mm/dd/yyyy' });

                const labels = shortageData.slice(1).map(row => {
                    const dateParts = row[0].split('/');
                    const month = parseInt(dateParts[0], 10) - 1;
                    const day = parseInt(dateParts[1], 10);
                    const year = parseInt(dateParts[2], 10);
                    const date = new Date(year, month, day);
                    return date.toLocaleString('default', { month: 'short', year: 'numeric' });
                });
                const indexValues = shortageData.slice(1).map(row => row[1]);

                new Chart(document.getElementById('shortageChart'), {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Shortage Index',
                            data: indexValues,
                            borderColor: 'blue',
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        title: {
                            display: true,
                            text: 'Monthly Shortage Index'
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error fetching or parsing the Excel file:', error);
            });
    });
</script>
    
    </body>
</html>
